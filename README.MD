# Iven API Documentation

## Authentication

### Register

```
POST /api/auth/register
Content-Type: application/json

{
  "username": "testuser",
  "email": "testuser@example.com",
  "password": "password123",
  "fname": "Pr√©nom",
  "lname": "Nom"
}   
```

**R√©ponse :**
```json
{
  "message": "Inscription r√©ussie ! Un code de confirmation √† 4 chiffres a √©t√© envoy√© √† votre email.",
  "userId": 123
}
```

### Confirm Email (Code √† 4 chiffres)

```
POST /api/auth/confirm-email
Content-Type: application/json

{
  "email": "testuser@example.com",
  "code": "1234"
}
```

**R√©ponse succ√®s :**
```json
{
  "message": "Compte activ√© avec succ√®s",
  "email": "testuser@example.com"
}
```

**R√©ponse erreur :**
```json
{
  "message": "Code invalide ou expir√©",
  "error": "Le code de confirmation est incorrect ou a expir√©. Veuillez demander un nouveau code."
}
```

### Resend Confirmation Code

```
POST /api/auth/resend-confirmation-email
Content-Type: application/json

{
  "email": "testuser@example.com"
}
```

**R√©ponse :**
```json
{
  "message": "Nouveau code de confirmation envoy√© par email"
}
```

### Login

```
POST /api/auth/login                                
Content-Type: application/json

{
  "email": "testuser@example.com",
  "password": "password123"
}
```

**R√©ponse succ√®s :**
```json
{
  "message": "Connexion r√©ussie",
  "token": "jwt_token_here",
  "user": {
    "id": 123,
    "username": "testuser",
    "email": "testuser@example.com",
    "active": 1
  }
}
```

**R√©ponse compte non activ√© :**
```json
{
  "message": "Votre compte n'est pas activ√©",
  "code": "not-activated",
  "user": {
    "username": "testuser",
    "fname": "Pr√©nom",
    "lname": "Nom",
    "email": "testuser@example.com",
    "active": 0
  }
}
```

### Forgot Password

```
POST /api/auth/forgot-password
Content-Type: application/json

{
  "email": "testuser@example.com"
}
```

## üõ†Ô∏è Base de donn√©es - Migration requise

Pour utiliser le nouveau syst√®me de codes de confirmation, ajoutez ces colonnes √† votre table `users` :

```sql
ALTER TABLE users 
ADD COLUMN confirmation_code VARCHAR(4) NULL,
ADD COLUMN confirmation_code_expires DATETIME NULL;

-- Index pour optimiser les performances (optionnel)
CREATE INDEX idx_users_confirmation_code ON users(confirmation_code, confirmation_code_expires);
```

## üì± Flux d'authentification pour React Native

1. **Inscription** : L'utilisateur s'inscrit ‚Üí re√ßoit un code √† 4 chiffres par email
2. **Confirmation** : L'utilisateur saisit le code dans l'app ‚Üí compte activ√©
3. **Connexion** : L'utilisateur peut se connecter normalement
4. **Renvoyer code** : Si le code expire, l'utilisateur peut en demander un nouveau

